<!DOCTYPE HTML>
<!--
 Solarize by TEMPLATED
 templated.co @templatedco
 Released for free under the Creative Commons Attribution 3.0 license (templated.co/license)
-->
<html>
 <head>
  <title>Principles of Programming Languages</title>
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />
  <meta name="description" content="" />
  <meta name="keywords" content="" />
  <!--[if lte IE 8]><script src="/pl/css/ie/html5shiv.js"></script><![endif]-->
  <script src="/pl/js/jquery.min.js"></script>
  <script src="/pl/js/jquery.dropotron.min.js"></script>
  <script src="/pl/js/skel.min.js"></script>
  <script src="/pl/js/skel-layers.min.js"></script>
  <script src="/pl/js/init.js"></script>
  <noscript>
   <link rel="stylesheet" href="/pl/css/skel.css" />
   <link rel="stylesheet" href="/pl/css/style.css" />
  </noscript>
  <!--[if lte IE 8]><link rel="stylesheet" href="/pl/css/ie/v8.css" /><![endif]-->
 </head>
 <body>

  <!-- Header Wrapper -->
   <div class="wrapper style1">
   
   <!-- Header -->
    <div id="header">
     <div class="container">
       
      <!-- Logo -->
       <h1><a href="/pl/index.html" id="logo">Principles of PL</a></h1>
      
      <!-- Nav -->
       <nav id="nav">
        <ul>
         <li class="active"><a href="/pl/index.html">Home</a></li>
         <li>
          <a href="/pl/logistics.html">Logistics</a>
          <ul class="menu">
          <li><a href="/pl/logistics.html">Overview</a></li>
           <li><a href="/pl/dateline.html">Dateline</a></li>
           <li><a href="https://gradescope.com">Gradescope</a></li>
           <li><a href="https://courselore.org/courses/8986607496">Q&amp;A</a></li>
           <li><a href="/pl/contact.html">Contact Us</a></li>
          </ul>
         </li>
         <li><a href="/pl/book">The Book</a>
         <ul class="menu">
         <li><a href="/pl/book/book.pdf">The book PDF</a></li>
         <li><a href="/pl/book/dist/">The FbDK dist</a></li>
       </ul></li>

         <li><a href="/pl/ocaml/index.html">OCaml</a>
         </li>
         <li><a href="">Assignments</a>
         <ul class="menu">
         <li><a href="/pl/assignments/assignment1.html">Assignment 1</a></li>
         <li><a href="/pl/assignments/assignment2.html">Assignment 2</a></li>
         <li><a href="/pl/assignments/assignment3.html">Assignment 3</a></li>
         <li><a href="/pl/assignments/assignment4.html">Assignment 4</a></li>
         <li><a href="/pl/assignments/assignment5.html">Assignment 5</a></li>
         <li><a href="/pl/assignments/assignment6.html">Assignment 6</a></li>
         <li><a href="/pl/assignments/assignment7.html">Assignment 7</a></li>
         <li><a href="/pl/assignments/assignment8.html">Assignment 8</a></li>
         <li><a href="/pl/assignments/assignment9.html">Assignment 9</a></li>
       </ul></li>
        </ul>
       </nav>
 
     </div>
    </div>
<!-- close-out code before the standard footer .. use to glue in raw html. -->
</div>
<!-- Main -->
<div id="main" class="wrapper style4">
<!-- Content -->
<div id="content" class="container">
<section>

<link rel="stylesheet" href="/pl/css/friendly.css" />
<meta charset="utf-8" />
    <h2 id="assignment-5-operational-equivalance-records-variants">Assignment 5: Operational Equivalance, Records, Variants</h2>

<ol>
  <li>
    <p>(10 points) Write an <strong>Fb</strong> function <code>cheapY</code> which works like the <code>Y</code>-combinator but only supports ten levels deep of recursive call. So for example</p>

    <div class="language-ocaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">cheapY</span> <span class="p">(</span><span class="nc">Function</span> <span class="n">this</span> <span class="o">-&gt;</span> <span class="nc">Function</span> <span class="n">x</span> <span class="o">-&gt;</span> <span class="nc">If</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">then</span> <span class="mi">1</span> <span class="nc">Else</span> <span class="n">x</span> <span class="o">+</span> <span class="n">this</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span> <span class="mi">10</span>
</code></pre></div>    </div>

    <p>returns <code>55</code> but if the <code>10</code> was replaced with <code>11</code> it diverges since the recursion tried to go 11 levels deep. This behavior is the same as a recursive function invocation with a runtime stack depth of at most 10 in e.g. the C language. Hint: you don’t actually need a counter to count the number of recursive calls, it is easier than that.</p>
  </li>
  <li>
    <p>(20 points) For each of the following potential operational equivalences for Fb, either prove that it holds by using the principles in Section 2.4.2 (using only a sequence of those principles and explicitly mentioning which principle is used in each step of the sequence – like a geometry proof), or present a counterexample context C invalidating it by the definition of ~= in Section 2.4.1.</p>

    <p>a. <code>Fun x -&gt; (Fun y -&gt; Not y) False</code> =~ <code>Fun x -&gt; True</code></p>

    <p>b. <code>Let x = f 0 In 0</code> ~= <code>0</code></p>

    <p>c. <code>(0 1)</code> ~= <code>((Fun x -&gt; 0) 1)</code></p>

    <p>d. <code>(Fun x -&gt; x = 0)</code> ~= <code>(Fun op -&gt; Fun x -&gt; op x 0)(Fun n1 -&gt; Fun n2 -&gt; n1 = n2)</code></p>

    <p>(Note that when you fill in the hole in a context <em>C</em>[<em>e</em>] for a counterexample, you should not change the parse precedence; in other words,  <em>C</em>[<em>e</em>] is always the same as <em>C</em>[<code>(</code><em>e</em><code>)</code>].)</p>
  </li>
  <li>
    <p>(20 points)  In lecture we defined <strong>FbR2</strong>, a record language which for simplicity always has <em>two</em> fields only.</p>

    <p>a. Generalize the grammar and rules given in lecture for <strong>FbR2</strong> to the case of full records, <strong>FbR</strong>: they can have from 0 to n fields in a given record.  Note that the book only gives an interpreter for <strong>FbR</strong> so it not much help.</p>

    <p>b. Use your rules to show</p>
    <div class="language-ocaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="nc">Let</span> <span class="n">f</span> <span class="o">=</span> <span class="nc">Fun</span> <span class="n">x</span> <span class="o">-&gt;</span> <span class="p">{</span> <span class="n">w</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">}</span> <span class="nc">In</span> <span class="p">(</span><span class="n">f</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">w</span> <span class="err">⇒</span> <span class="mi">1</span>
</code></pre></div>    </div>
    <p>by building the full proof tree.</p>
  </li>
  <li>
    <p>(15 points) In lecture we outlined how records could be used to encode variants: every <em>definition</em> of a variant could be encoded by a <em>use</em> (projection) of a record, and every <em>use</em> of a variant could be encoded as a <em>definition</em> of a record.  The opposite is also possible, encoding records in terms of variants.  For this question, take the small example <strong>FbR</strong> program</p>

    <div class="language-ocaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Let</span> <span class="n">r</span> <span class="o">=</span> <span class="p">{</span><span class="n">w</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span> <span class="n">h</span> <span class="o">=</span> <span class="mi">6</span> <span class="o">+</span> <span class="mi">5</span> <span class="p">}</span> <span class="nc">In</span> <span class="n">r</span><span class="o">.</span><span class="n">h</span> <span class="o">+</span> <span class="mi">3</span>
</code></pre></div>    </div>

    <p>and define an equivalent <strong>FbV</strong> program (i.e. returning the same result) which follows the  pattern of the record encoding of variants: encode record definitions as variant uses (<code>Match</code>es), and encodes record uses as variant definitions.  Your answer will need to look like this:</p>

    <div class="language-ocaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Let</span> <span class="n">r</span> <span class="o">=</span> <span class="c">(* ... some FbV code with a Match *)</span> <span class="nc">In</span> <span class="c">(* Some FbV code with a variant definition *)</span><span class="o">+</span> <span class="mi">3</span>
</code></pre></div>    </div>

    <p>Your encoding should be such that the concept should work for any record definition and use, so don’t just make something working for this example.</p>
  </li>
  <li>
    <p>(10 points) Make direct operational semantics rules for the freeze and thaw macros we defined for <strong>Fb</strong>. This means we are making a new programming language, <strong>FbFT</strong> (<strong>Fb</strong> extended with freeze and thaw).  You <em>must</em> write a rule that actually does the “work” of the construct; don’t just make a rule which is justr expanding like a macro.  Concretely, your rule(s) <em>cannot</em> have any <code>Fun ..</code> or applications in them either above or below the line.  To help you get going, the grammar for <strong>FbFT</strong> is as follows:</p>

    <div class="language-ocaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="n">v</span> <span class="o">::=</span> <span class="c">(* all Fb clauses *)</span> <span class="o">|</span> <span class="nc">Freeze</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> 
 <span class="n">e</span> <span class="o">::=</span> <span class="c">(* all Fb clauses *)</span> <span class="o">|</span> <span class="nc">Thaw</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</code></pre></div>    </div>
    <p>You don’t need to write out all the existing Fb rules, it is OK to state (* insert all Fb rules here *).</p>
  </li>
</ol>

<h3 id="submission-and-grading">Submission and Grading</h3>

<p>Upload your homework pdf to Gradescope as was done in HW 3. <em>Please remember to list any collaborators at the top of your submission as was done in assignments 1-4</em>.</p>
      
          </section>
        </div>
      </div>

				<div id="copyright">
					Web Design: <a href="http://templated.co">TEMPLATED</a> Images: <a href="http://unsplash.com">Unsplash</a> (<a href="http://unsplash.com/cc0">CC0</a>)
				</div>			


   </body>
</html>
