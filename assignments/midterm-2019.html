<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html> <head>
<title>PL Midterm 2019</title>
</HEAD>
<BODY LINK="#0000FF" VLINK="#800080" bgcolor="#F0FFF0">
<h3> 601.426/626, Princples of Programming Languages
<br> Spring 2019
<br> Midterm Examination
<br> 
</h3>
Your Name (please write neatly to help Gradescope recognize it): _________________________________<p>

You can use one handwritten 8.5x11 notes sheet.  Please put your name on your sheet, and we will be collecting them at the end of the exam.
<strong>Good Luck!</strong>
<hr>
<ol>
  <li>[12 points] Show how <tt>e1 < e2</tt>, a comparison operator on integers, can be added to <strong>Fb</strong>:
<ol type ="a">
  <li>Define any extension to the grammar of expressions and/or values, if needed</li>
 <li>Define any new operational semantics rule(s) needed, and </li>
 <li>Also show how the <strong>Fb</strong> interpreter could be extended for this new operation by sketching how the <tt>expr</tt> type and <tt>eval</tt> function could be extended.
</ol>
You can phrase all of these as extensions of the existing items, liberal use of "..." is good!

    <p style="page-break-after:always;"></p>
  

     <li>[12 points]  For each of these questions either write out the derivation tree for the operational semantics of the indicated <strong>Fb</strong> program, or show clearly why no such tree could ever be constructed.
    
<ol type="a">
  <li>
    <tt>If True Then 5 Else (0 1)</tt>
  <li>
    <tt>Not( Not( 0 ) )</tt>
  <li>
    <tt>(Fun n -> If n = 0 Then (Fun z -> z + 1) Else (Fun z -> z - 1)) 4 5</tt>
    </ol>

   <p style="page-break-after:always;"></p>
    
  <li>[12 points]
    One topic we did not cover in lecture is that the integers in <strong>Fb</strong> are not even necessary, integers themselves can be encoded.  There are many ways to encode integers but for this question we want you to show how integers can be encoded in terms of <em>lists</em> - the length of the list is the number (note that for simplicity we will encode natural numbers only - no negative numbers).  So for example the list <tt>[True; True; True]</tt> can be viewed as the number <tt>3</tt> as it is a list of length 3.  We already showed how lists can be encoded in <strong>Fb</strong>, but for simplicity you can use normal OCaml syntax with capitalized keywords when answering this question.  So for example <tt>True :: l</tt> or <tt>Match l With [] -> ... | x :: y -> ...</tt>  are fair to use in your <strong>Fb</strong> code answers here if you so choose.<br>
    Concretely, for this question show how
    <ol type="a">
      <li> <tt>e1 + e2</tt>,</li>
      <li> <tt>e1 - e2</tt>, and</li>
      <li> <tt>e1 = e2</tt>
    </ol>
    can each be encoded as two-argument <strong>Fb</strong> functions on lists.  None of your code can use integer constants, <tt>+</tt> <tt>-</tt> or <tt>=</tt> operations in <strong>Fb</strong>.  Note that the contents of the lists themselves are irrelevant, for example all the elements of your lists can be e.g. <tt>True</tt>.  Since subtraction is defined on naturals only, subtracting a larger number from a smaller number can just return <tt>[ ]</tt> (empty list, the encoding of <tt>0</tt>).
      <p style="page-break-after:always;"></p>
      
  <li>[4 points]
    Suppose some hackers figured out how to subvert the <tt>=</tt> operation in <strong>Fb</strong> in a way that if a program ever compared for <tt>0 = 0</tt> the CPU would overheat and melt and possibly burst into flames. More generally, any comparison <tt>e1 = e2</tt> for both <tt>e1</tt> and <tt>e2</tt> evaluating to <tt>0</tt> would cause melt-down.<br>
    
For this question, your goal is to patch existing code so CPUs will not melt.  Show how you could write a replacement operation <tt>FixEq</tt> for <tt>e1 = e2</tt>, a 2-argument <strong>Fb</strong> function, such that given a Fb expression e, if you replaced all the <tt>e1 = e2</tt> in it with <tt>FixEq (e1) (e2)</tt> the program would produce the same results as the original program would have on an un-hacked machine.  In other words, your <tt>FixEq</tt> needs to check for equality but it needs to somehow never check for <tt>0=0</tt>.  Unlike the previous question you can still use integer constants, <tt>=</tt>, etc, just make sure you don't melt the machine.

<li>Appendix: operational equivalence.  Either prove these fail by constructing a context C, or use the principles in the book to prove they hold.

<ul>
  <li> <tt>(Function x -> Function y -> y) e1 e2 =~ e2</tt>
  <li> <tt>(Function x -> y) =~ (Function y -> x)</tt>
  <li> <tt>If x Then True Else False =~ x</tt> 
  <li> <tt>e1 + x =~ x + e1</tt> 
  </ul>
    </body> </html>
