<!DOCTYPE HTML>
<!--
 Solarize by TEMPLATED
 templated.co @templatedco
 Released for free under the Creative Commons Attribution 3.0 license (templated.co/license)
-->
<html>
 <head>
  <title>Principles of Programming Languages</title>
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />
  <meta name="description" content="" />
  <meta name="keywords" content="" />
  <!--[if lte IE 8]><script src="/pl/css/ie/html5shiv.js"></script><![endif]-->
  <script src="/pl/js/jquery.min.js"></script>
  <script src="/pl/js/jquery.dropotron.min.js"></script>
  <script src="/pl/js/skel.min.js"></script>
  <script src="/pl/js/skel-layers.min.js"></script>
  <script src="/pl/js/init.js"></script>
  <noscript>
   <link rel="stylesheet" href="/pl/css/skel.css" />
   <link rel="stylesheet" href="/pl/css/style.css" />
  </noscript>
  <!--[if lte IE 8]><link rel="stylesheet" href="/pl/css/ie/v8.css" /><![endif]-->
 </head>
 <body>

  <!-- Header Wrapper -->
   <div class="wrapper style1">
   
   <!-- Header -->
    <div id="header">
     <div class="container">
       
      <!-- Logo -->
       <h1><a href="/pl/index.html" id="logo">Principles of PL</a></h1>
      
      <!-- Nav -->
       <nav id="nav">
        <ul>
         <li class="active"><a href="/pl/index.html">Home</a></li>
         <li>
          <a href="/pl/logistics.html">Logistics</a>
          <ul class="menu">
           <li><a href="/pl/dateline.html">Dateline</a></li>
           <li><a href="https://gradescope.com">Gradescope</a></li>
           <li><a href="https://campuswire.com/c/G9E051068">Q&amp;A</a></li>
           <li><a href="/pl/contact.html">Contact Us</a></li>
          </ul>
         </li>
         <li><a href="/pl/book">The Book</a>
         <ul class="menu">
         <li><a href="/pl/book/book.pdf">The book PDF</a></li>
         <li><a href="/pl/book/dist/">The FbDK dist</a></li>
       </ul></li>

         <li><a href="/pl/ocaml/index.html">OCaml</a>
         </li>
         <li><a href="">Assignments</a>
         <ul class="menu">
         <li><a href="/pl/assignments/assignment1.html">Assignment 1</a></li>
         <li><a href="/pl/assignments/assignment2.html">Assignment 2</a></li>
         <li><a href="/pl/assignments/assignment3.html">Assignment 3</a></li>
         <li><a href="/pl/assignments/assignment4.html">Assignment 4</a></li>
         <li><a href="/pl/assignments/assignment5.html">Assignment 5</a></li>
         <li><a href="/pl/assignments/assignment6.html">Assignment 6</a></li>
         <li><a href="/pl/assignments/assignment7.html">Assignment 7</a></li>
         <li><a href="/pl/assignments/assignment8.html">Assignment 8</a></li>
         <li><a href="/pl/assignments/assignment9.html">Assignment 9</a></li>
       </ul></li>
        </ul>
       </nav>
 
     </div>
    </div>
<!-- close-out code before the standard footer .. use to glue in raw html. -->
</div>
<!-- Main -->
<div id="main" class="wrapper style4">
<!-- Content -->
<div id="content" class="container">
<section>

<link rel="stylesheet" href="/pl/css/friendly.css" />
<meta charset="utf-8" />
    <h2 id="assigment-8---type-systems">Assigment 8 - Type Systems</h2>

<ol>
  <li>
    <p>(15 points) For each of these expressions, either construct a typing proof in <strong>TFb</strong> <strong>or</strong> show exactly why they cannot typecheck (i.e. no derivation tree could ever be built; don’t just informally describe it, use the formal system rules).</p>

    <p>a.  <code>If True Then 0 Else False</code></p>

    <p>b.  <code>(If True Then (Fun x:Int -&gt; x + 1) Else (Fun x:Int -&gt; x)) 0</code></p>

    <p>c.  <code>(Fun x:(Int -&gt; Int) -&gt; x False)</code></p>
  </li>
  <li>
    <p>(25 points)  This question concerns subtyping.</p>

    <p>a.  Complete and type the following expression in <strong>STFbR</strong> (note this program is not showing the type declarations on <code>r1/r2</code>, you need figure those out):</p>

    <div class="language-ocaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="nc">Fun</span> <span class="n">n</span><span class="o">:</span><span class="nc">Int</span> <span class="o">-&gt;</span> <span class="nc">Fun</span> <span class="n">r1</span><span class="o">:</span><span class="p">{</span><span class="o">...</span><span class="p">}</span> <span class="o">-&gt;</span> <span class="nc">Fun</span> <span class="n">r2</span><span class="o">:</span><span class="p">{</span><span class="o">...</span><span class="p">}</span> <span class="o">-&gt;</span>
   <span class="p">{</span><span class="n">x</span> <span class="o">=</span> <span class="n">r1</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span> <span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="nc">If</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span> <span class="nc">Then</span> <span class="n">r1</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="mi">1</span> <span class="nc">Else</span> <span class="n">r2</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span><span class="mi">1</span><span class="p">);</span> <span class="n">z</span> <span class="o">=</span>  <span class="n">r2</span><span class="o">.</span><span class="n">z</span> <span class="o">+</span> <span class="mi">2</span><span class="p">}</span>
</code></pre></div>    </div>

    <p>(You only need to give the type of the above expression, you don’t need to show the full type derivation.)</p>

    <p>b.  Now write a nontrivial subtype of your answer to a) which changes as many of the record types as you can.</p>

    <p>c. Give the proof tree showing that your subtyping from part b. holds using the subtype rules covered in lecture and in Section 6.5.2.</p>
  </li>
  <li>
    <p>(25 points) For this question we will extend <strong>FbV</strong> with types, producing <strong>TFbV</strong>. In this question you are to make a type system for <strong>TFbV</strong>. Most of the rules are the same as <strong>TFb</strong> and you do not need to repeat those rules.  Variant types are added to <strong>TFb</strong>’s type grammar, of the syntactic form <code>`good(Int) | `bad(Bool)</code> (which would be <code>type eg = Good of int | Bad of bool</code> in OCaml).</p>

    <p>Rather than adding variant type declarations like in OCaml, we are going to simply inline the variant type everywhere it is used.  (Yes this is a bit ugly.  But it is simple.) In particular, the <strong>FbV</strong> syntax <code>`n(e)</code> becomes <code>`n(e):τ</code> in <strong>TFbV</strong> - <em>all</em> variant data is tagged with its variant type. For example: <code>`good(0): `good(Int) | `bad(Bool)</code>.  Note what you generally <em>don’t</em> want to do in a program is to say <code>`good(0): `good(Int)</code> - that would mean there is no other variant ever possible (note if we had subtyping on variant types we could do that, but we do not).</p>

    <p>a.  Your task is to write the new type rules beyond those already present in <strong>TFb</strong> to make a full type system for <strong>TFbV</strong>.  Please make your rule be strict in that all cases in the type must be in the <code>Match</code> clause – OCaml will sometimes give a warning if there is a case missing, you should not allow those programs to typecheck in your rule.</p>

    <p>b.  Show your rules work by proving the simple program</p>

    <div class="language-ocaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="nc">Fun</span> <span class="n">goo</span> <span class="o">-&gt;</span>  <span class="nc">Match</span> <span class="n">goo</span> <span class="nc">With</span> <span class="nt">`good</span><span class="p">(</span><span class="n">_</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="mi">0</span> <span class="o">|</span> <span class="nt">`bad</span><span class="p">(</span><span class="n">_</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="mi">1</span><span class="p">)(</span><span class="nt">`good</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">:</span> <span class="nt">`good</span><span class="p">(</span><span class="nc">Int</span><span class="p">)</span> <span class="o">|</span> <span class="nt">`bad</span><span class="p">(</span><span class="nc">Bool</span><span class="p">))</span>
</code></pre></div>    </div>

    <p>typechecks: construct the type tree for it using your rules.</p>

    <p>c.  Propose subtyping rules for a <strong>STFbV</strong> extension to <strong>TFbV</strong>.  Hint: variants are <em>unions</em> of different possible tags, and subtyping can be modeled as a subset as we covered in lecture.  Give the full <code>&lt;:</code> rule set; you are welcome to borrow subtyping rules from <strong>STFbR</strong>.</p>
  </li>
</ol>
      
          </section>
        </div>
      </div>

				<div id="copyright">
					Web Design: <a href="http://templated.co">TEMPLATED</a> Images: <a href="http://unsplash.com">Unsplash</a> (<a href="http://unsplash.com/cc0">CC0</a>)
				</div>			


   </body>
</html>
